<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Карта кофеен</title>
  <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
  <style>
    body { margin: 0; padding: 0; font-family: Arial, sans-serif; }
    #map { width: 100%; height: calc(100vh - 100px); } /* карта занимает всё, кроме шапки и фильтров */

    .header {
      background: #fff;
      padding: 10px;
      border-bottom: 1px solid #ddd;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .filters {
      display: flex;
      gap: 10px;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid #ddd;
      background: #fafafa;
      position: relative;
      z-index: 2;
    }

    /* Кнопка для списка */
    .toggle-list {
      padding: 6px 12px;
      background: #ff914d;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    /* Панель списка кофеен */
    .coffee-list {
      position: fixed;
      left: -300px; /* прячем слева */
      width: 300px;
      height: calc(100vh - var(--filters-bottom, 100px)); /* динамическая высота */
      background: #fff;
      border-right: 1px solid #ddd;
      overflow-y: auto;
      transition: left 0.3s ease;
      z-index: 3;
    }
    .coffee-list.active {
      left: 0; /* выезжает */
    }

    .coffee-item {
      padding: 10px;
      border-bottom: 1px solid #eee;
      cursor: pointer;
    }
    .coffee-item:hover {
      background: #f5f5f5;
    }

    /* Балуны на мобилке */
    .ymaps-2-1-79-balloon {
      max-width: 90% !important;
      left: 5% !important;
      right: 5% !important;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1 style="display:flex; align-items:center; gap:10px;">
      <img src="https://github.com/maksdecept97-crypto/coffeemap/blob/main/logo.jpg?raw=true"
           alt="Логотип" style="height:40px; display:block;">
      Где найти своё Тепло
    </h1>
  </div>

  <div class="filters">
    <button class="toggle-list">Список</button>
    <input type="text" class="search-box" placeholder="Поиск кофеен...">
    <!-- сюда можно добавить фильтры -->
  </div>

  <!-- Выезжающий список -->
  <div class="coffee-list" id="coffeeList">
    <div class="coffee-item" data-coords="[59.911946, 30.316499]">Tour Coffee</div>
    <div class="coffee-item" data-coords="[59.960012, 30.311556]">UNIC</div>
    <div class="coffee-item" data-coords="[59.932235, 30.346676]">Verlé</div>
    <!-- остальные кофейни -->
  </div>

  <div id="map"></div>

  <script>
    ymaps.ready(init);

    function init() {
      var map = new ymaps.Map("map", {
        center: [59.93, 30.34],
        zoom: 12
      });

      // Кофейни
      var coffees = [
        {
          name: "Tour Coffee",
          coordinates: [59.911946, 30.316499],
          description: "Tour coffee — это предвкушение чего-то нового...",
          address: "7-я Красноармейская ул., 5Д"
        },
        {
          name: "UNIC",
          coordinates: [59.960012, 30.311556],
          description: "UNIC — место, куда хочется приходить...",
          address: "ул. Кронверская, 12"
        },
        {
          name: "Verlé",
          coordinates: [59.932235, 30.346676],
          description: "Verlé — современное место с видом на сквер Низами...",
          address: "ул. Некрасова, 20"
        }
      ];

      // Добавляем маркеры
      coffees.forEach(coffee => {
        var placemark = new ymaps.Placemark(coffee.coordinates, {
          balloonContentHeader: coffee.name,
          balloonContentBody: `<p>${coffee.description}</p>`,
          balloonContentFooter: coffee.address
        }, {
          iconLayout: 'default#image',
          iconImageHref: 'https://github.com/maksdecept97-crypto/coffeemap/blob/main/cartpoint.png?raw=true',
          iconImageSize: [32, 32],
          iconImageOffset: [-16, -16]
        });
        map.geoObjects.add(placemark);
      });

      // Закрывать балун при клике по карте
      map.events.add('click', function () {
        map.balloon.close();
      });
    }

    // ==== ЛОГИКА СПИСКА ====
    const list = document.getElementById("coffeeList");
    const btn = document.querySelector(".toggle-list");

    btn.addEventListener("click", () => {
      list.classList.toggle("active");
    });

    // Закрывать список при клике вне
    document.addEventListener("click", (e) => {
      if (!list.contains(e.target) && !btn.contains(e.target)) {
        list.classList.remove("active");
      }
    });

    // ==== ПРИВЯЗКА ВЫСОТЫ ПАНЕЛИ К ФИЛЬТРАМ ====
    function updateListPosition() {
      const filters = document.querySelector(".filters");
      const rect = filters.getBoundingClientRect();
      const filtersBottom = rect.bottom + window.scrollY;
      document.documentElement.style.setProperty("--filters-bottom", filtersBottom + "px");
      list.style.top = filtersBottom + "px";
    }
    window.addEventListener("resize", updateListPosition);
    window.addEventListener("load", updateListPosition);
  </script>
</body>
</html>
