<!DOCTYPE html>
<html>
<head>
    <title>Карта кофеен</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
    <style>
        #map { width: 100%; height: 100vh; }
        body { margin: 0; padding: 0; }

        /* Один скролл у всего балуна */
        .ymaps-2-1-79-balloon__content {
            max-height: 450px !important;
            overflow-y: auto !important;
        }

        iframe {
            overflow: hidden !important;
        }
    </style>
</head>
<body>
<div id="map"></div>

<script>
ymaps.ready(init);

function init() {
    var map = new ymaps.Map("map", {
        center: [59.93, 30.34],
        zoom: 12,
        controls: ["geolocationControl", "zoomControl"]
    });

    var coffee1 = new ymaps.Placemark([59.911946, 30.316499], {
        balloonContentHeader: "Tour Coffee",
        balloonContentBody: `
            <p>Tour coffee — это предвкушение чего-то нового: разные сорта, разные обжарщики. 
            Интересно пробовать и знать, что приготовят его хорошо. 
            Здесь подают шикарные гриль-чизы и свежие десерты. И конечно же вкусный кофе.</p>
            <img src="" width="100">
        `,
        balloonContentFooter: '7-я Красноармейская ул., 5Д'
    }, { preset: 'islands#icon', iconColor: '#b84114' });

    var coffee2 = new ymaps.Placemark([59.960012, 30.311556], {
        balloonContentHeader: "UNIC",
        balloonContentBody: `
            <p>UNIC — место, куда хочется приходить — за вкусной едой, кофе и разговором 
            с теми, кто по-настоящему увлечён своим делом.</p>
            <iframe src="https://t.me/teplo_coffeeroutes/8?embed=1"
                width="320" height="420"
                frameborder="0" scrolling="no" style="overflow:hidden;"></iframe>
        `,
        balloonContentFooter: 'ул. Кронверская, 12'
    }, { preset: 'islands#icon', iconColor: '#ff4500' });

    map.geoObjects.add(coffee1);
    map.geoObjects.add(coffee2);

    ymaps.geolocation.get({
        provider: "browser",
        mapStateAutoApply: true
    }).then(function (result) {
        var userCoords = result.geoObjects.position;
        if (userCoords) {
            var userMarker = new ymaps.Placemark(userCoords, {
                balloonContent: 'Вы здесь'
            }, {
                preset: 'islands#circleIcon',
                iconColor: '#3399ff'
            });
            map.geoObjects.add(userMarker);
            map.setCenter(userCoords);
        }
    }, function (err) {
        console.log("Геолокация недоступна:", err);
    });
}
</script>
</body>
</html>
